@* @page "/test"

@inject IFormData FormData


@code {
    private List<Form> forms;

    private int formsUpdatedCount = 0; // Counter for the forms updated

    protected override async Task OnInitializedAsync()
    {
        forms = await FormData.GetForms();

        foreach (var form in forms) 
        {
            if (form.StatusInfo.Status == "Reviewed")   
            {
                var lastTracking = form.FormHistory.LastOrDefault();

                if (lastTracking.PerformedById == "65e3a284743ca4b3aa40f197")
                {
                    if (lastTracking.Descriptions.Contains("Form status changed to 'Reviewed' by Adan A. (Admin)."))
                    {
                        // To remove the specific string from the list
                        bool isRemoved = lastTracking.Descriptions.Remove("Email Notification of Pending Status Sent to Registrant.");

                        if (isRemoved)
                        {
                            await FormData.UpdateForm(form);
                            formsUpdatedCount++; // Increment the counter
                            Console.WriteLine(formsUpdatedCount);
                        }
                    }
                }
            }
        }

    }
}
 *@